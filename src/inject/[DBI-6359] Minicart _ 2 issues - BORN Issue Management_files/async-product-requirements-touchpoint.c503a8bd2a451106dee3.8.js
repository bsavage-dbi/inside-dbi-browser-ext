try{window.performance.mark("async-product-requirements-touchpoint.js:eval-start")}catch(e){}(window.webpackJsonp=window.webpackJsonp||[]).push([["async-product-requirements-touchpoint"],{"./src/packages/common-legacy-do-not-add-anything-new/src/growth-experiments/fire-feature-exposure-event.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var n=s("./node_modules/lodash/get.js"),a=s.n(n),r=s("./src/packages/common-legacy-do-not-add-anything-new/src/util/jira-feature-flag-client.js");const c=(e,t,s={})=>{const n=t.value;n.startsWith("not-enrolled")||Object(r.a)().trackExposure(e,{value:n,explanation:{kind:a()(t,"explanation.kind"),ruleId:a()(t,"explanation.ruleId")}},s)}},"./src/packages/common-legacy-do-not-add-anything-new/src/growth-experiments/get-feature-flag-value.js":function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var n=s("./node_modules/lodash/get.js"),a=s.n(n),r=s("./src/packages/common-legacy-do-not-add-anything-new/src/util/get-all-feature-flags.js");const c=e=>{const t=Object(r.a)(),s=a()(t,[e]);return void 0===s?{value:"not-enrolled",explanation:{ruleId:null,kind:"INELIGIBLE"}}:s}},"./src/packages/issue/issue-view/src/views/issue-base/content/product-requirements-touchpoint/index.js":function(e,t,s){"use strict";s.r(t);var n=s("./node_modules/react/index.js"),a=s.n(n),r=s("./src/packages/platform/ui/error-boundary/src/main.js"),c=s("./src/packages/platform/observability/product-analytics-bridge/src/utils/analytics-context-wrapper.js"),i=s("./src/packages/platform/observability/product-analytics-bridge/src/constants.js"),o=s("./src/packages/platform/controllers/tenant-context/src/components/index.js"),u=s("./node_modules/react-redux/es/index.js"),l=s("./node_modules/@atlassiansox/cross-flow-support/dist/esm/index.js"),d=s("./node_modules/@atlaskit/analytics-next/dist/esm/useAnalyticsEvents.js"),p=s("./src/packages/common-legacy-do-not-add-anything-new/src/growth-experiments/fire-feature-exposure-event.js"),m=s("./src/packages/common-legacy-do-not-add-anything-new/src/growth-experiments/get-feature-flag-value.js"),g=s("./src/packages/issue/issue-context-service/src/main.js"),f=s("./src/packages/platform/observability/product-analytics-bridge/src/utils/fire-analytics.js"),b=s("./src/packages/issue/issue-view/src/common/state/selectors/issue-selector.js"),j=s("./src/packages/issue/issue-view/src/feature-flags.js"),y=s("./src/packages/issue/issue-view/src/issue-field/state/selectors/epic-selector.js"),x=s("./src/packages/platform/utils/fetch/src/utils/requests.js");var O=s("./src/packages/common-legacy-do-not-add-anything-new/src/storage/storage-provider.js"),w=s("./src/packages/common-legacy-do-not-add-anything-new/src/util/get-tenant-context/index.js");function h(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function E(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?h(Object(s),!0).forEach((function(t){k(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):h(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function k(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const v="product-requirements-flag",C=(()=>{let e,t=null;try{e=Object(w.c)()}catch(e){return t}const{atlassianAccountId:s}=e;return s&&(t=Object(O.b)(`local-storage-${s.replace(/:/g,"_")}`)),t})(),q=()=>{let e;return C&&(e=C.get(v)),e||(e={status:!1,lastSeenDate:null,seenCount:0},C&&C.set(v,e)),e};function P(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),s.push.apply(s,n)}return s}function D(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?P(Object(s),!0).forEach((function(t){S(e,t,s[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):P(Object(s)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))}))}return e}function S(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const M=["mobile-issue","bitbucket-issue"];var T=Object(u.b)(e=>({isEpic:Object(y.b)(e),projectKey:Object(b.D)(e)}),{})(({children:e,projectKey:t,isEpic:s,analyticsContext:a})=>{const{createAnalyticsEvent:r}=Object(d.a)(),c=Object(g.a)(),i=Object(l.c)(),u=Object(g.d)(),b=Object(g.b)(),{cloudId:y,isSiteAdmin:O,areProductSuggestionsEnabled:w,atlassianAccountId:h,licensedProducts:k}=Object(o.l)(),[P,S]=Object(n.useState)({shouldRenderExperiment:!1}),[T,I]=Object(n.useState)(null);Object(n.useEffect)(()=>{I(i.isEnabled&&O&&s&&!b&&-1===M.indexOf(c)&&!k.confluence&&w)},[c,w,h,i.isEnabled,s,b,O,k.confluence]),Object(n.useEffect)(()=>{if(h&&!0===T)try{const e=q();S({shouldRenderExperiment:"variation"===Object(j.getProductRequirementsDocDiscoveryFlag)()&&void 0!==e&&!e.status})}catch(e){Object(f.b)(r({}),"productRequirementsFlagFetch failed"),S({shouldRenderExperiment:!1})}},[h,r,T]),Object(n.useEffect)(()=>{!0===T?Object(p.a)("growth-experiment-product-requirements-doc-discovery",Object(m.a)("growth-experiment-product-requirements-doc-discovery"),a):!1!==T||k.confluence||Object(f.f)(r({}),"notEligibleForProductRequirementsExperiment registered",{isCrossFlowEnabled:i.isEnabled,areProductSuggestionsEnabled:w})},[a,w,r,i.isEnabled,O,T,k.confluence]),Object(n.useEffect)(()=>{P.shouldRenderExperiment&&(()=>{if(C){const e=C.get(v);e&&(null===e.lastSeenDate||Date.now()-new Date(e.lastSeenDate)>5e3)&&C.set(v,E(E({},e),{},{seenCount:e.seenCount+1,lastSeenDate:(new Date).toISOString()}))}})()},[P]);const N=Object(n.useCallback)(()=>{if(h)try{S({shouldRenderExperiment:!1}),(()=>{if(C){const e=C.get(v);if(e&&e.status)return;const t=new Date;C.set(v,E(E({},e),{},{status:!0,lastSeenDate:t.toISOString()}))}})()}catch(e){Object(f.b)(r({}),"productRequirementsFlagSet failed")}},[h,r]),R=Object(n.useCallback)(async()=>{if(i.isEnabled){await i.api.open({journey:l.a.DECIDE,targetProduct:l.b.CONFLUENCE,sourceComponent:"product-requirements",sourceContext:"epic-issue-view",experimentalOptions:{isCrossSell:!0,isInJswToConfluenceProductRequirementsExperiment:!0,jiraProjectKey:t,jiraIssueKey:u}});try{await(async e=>{const t=(await Object(x.b)(`/gateway/api/xflow/${e}/license-information`)).products["confluence.ondemand"];return t&&"ACTIVE"===t.state})(y)&&S({shouldRenderExperiment:!1})}catch(e){Object(f.b)(r({}),"tenantHasConfluenceCheck failed")}}},[i,y,u,t,r]);return e(D(D({},P),{},{onDismissClick:N,onTryItNowClick:R}))}),I=s("./node_modules/react-intl/lib/index.es.js"),N=s("./node_modules/@atlaskit/button/dist/esm/components/Button.js"),R=s("./node_modules/@atlaskit/lozenge/dist/esm/Lozenge/index.js"),_=s("./node_modules/@atlaskit/tooltip/dist/esm/Tooltip.js"),F=s("./src/packages/platform/controllers/intl/src/index.js"),A=s("./src/packages/platform/observability/product-analytics-bridge/src/utils/fire-analytics-component.js"),B=s("./src/packages/issue/issue-view/src/views/issue-base/content/product-requirements-touchpoint/messages.js"),L=s("./node_modules/styled-components/dist/styled-components.browser.esm.js"),z=s("./node_modules/@atlaskit/theme/dist/esm/index.js");const J=L.default.div(["padding:16px;box-shadow:0px 3px 5px rgba(9,30,66,0.2),0px 0px 1px rgba(9,30,66,0.31);border-radius:4px;button{margin-top:8px;}"]),K=L.default.div(["font-size:11px;color:",";text-transform uppercase;font-weight:500;"],z.a.N100),G=L.default.div(["font-size:14px;margin-top:8px;color:",";font-weight:500;"],z.a.N800),V=L.default.div(["font-size:14px;margin-top:4px;color:",";"],z.a.N400),W=L.default.div(["display:inline-block;height:auto;width:8px;"]),$=L.default.div(["button{margin-top:12px;}> div{display:inline-block;}"]),H=L.default.span(["margin-left:7px;"]),U=(e,t)=>(s,n)=>{const a=q();Object(f.h)(n,t,a?{seenCount:a.seenCount}:void 0),e()};var Q=e=>{const{onDismissClick:t,onTryItNowClick:s}=e,{formatMessage:r}=Object(F.c)(),c=Object(n.useCallback)(U(t,"dismissButton"),[t]),i=Object(n.useCallback)(U(s,"tryThisTemplateButton"),[s]);return a.a.createElement(J,null,a.a.createElement(A.b,null),a.a.createElement(K,null,a.a.createElement(I.FormattedMessage,B.a.recommendedTemplate)),a.a.createElement(G,null,a.a.createElement(I.FormattedMessage,B.a.productRequirements),a.a.createElement(H,null,a.a.createElement(R.a,{appearance:"inprogress"},a.a.createElement(I.FormattedMessage,B.a.tryLozenge)))),a.a.createElement(V,null,a.a.createElement(I.FormattedMessage,B.a.description)),a.a.createElement($,null,a.a.createElement(_.a,{content:r(B.a.tooltipText)},a.a.createElement(N.a,{onClick:i},a.a.createElement(I.FormattedMessage,B.a.tryButton))),a.a.createElement(W,null),a.a.createElement(N.a,{appearance:"subtle",onClick:c},a.a.createElement(I.FormattedMessage,B.a.dismissButton))))};t.default=()=>{const{isSiteAdmin:e,licensedProducts:t}=Object(o.l)(),s={isSiteAdmin:e,hasConfluence:!!t.confluence,hasLinkedSpace:!1,journey:"pre-expand"};return a.a.createElement(c.a,{sourceName:"productRequirementsTouchpoint",sourceType:i.f,attributes:s},a.a.createElement(r.a,{id:"product-requirements-touchpoint",packageName:"issue"},a.a.createElement(T,{analyticsContext:s},({shouldRenderExperiment:e,onDismissClick:t,onTryItNowClick:s})=>e?a.a.createElement(Q,{onTryItNowClick:s,onDismissClick:t}):null)))}},"./src/packages/issue/issue-view/src/views/issue-base/content/product-requirements-touchpoint/messages.js":function(e,t,s){"use strict";var n=s("./node_modules/react-intl/lib/index.es.js");t.a=Object(n.defineMessages)({recommendedTemplate:{id:"issue.details.confluence-pages.product-requirements.recommended-template",defaultMessage:"Recommended template"},productRequirements:{id:"issue.details.confluence-pages.product-requirements.product-requirements",defaultMessage:"Product requirements"},tryLozenge:{id:"issue.details.confluence-pages.product-requirements.try",defaultMessage:"Try"},description:{id:"issue.details.confluence-pages.product-requirements.description",defaultMessage:"Align your team\u2019s vision, goals, and milestones on a single page. Automatically links with this Jira epic."},tryButton:{id:"issue.details.confluence-pages.product-requirements.try-button",defaultMessage:"Try this template"},dismissButton:{id:"issue.details.confluence-pages.product-requirements.dismiss-button",defaultMessage:"Dismiss"},tooltipText:{id:"issue.details.confluence-pages.product-requirements.tooltip",defaultMessage:"Starts a Confluence trial"},templateOpensInConfluenceTooltip:{id:"issue.details.confluence-pages.product-requirements.template-opens-in-confluence",defaultMessage:"Template opens in Confluence"},pageNotCreatedTitle:{id:"issue.details.confluence-pages.product-requirements.page-not-created.title",defaultMessage:"Page not created"},pageNotCreatedDescription:{id:"issue.details.confluence-pages.product-requirements.page-not-created.description",defaultMessage:"We couldn\u2019t create this page from Jira. Try creating it from Confluence instead."},pageNotCreatedGoToConfluence:{id:"issue.details.confluence-pages.product-requirements.page-not-created.confluence",defaultMessage:"Go to Confluence"},pageNotCreatedContactSupport:{id:"issue.details.confluence-pages.product-requirements.page-not-created.support",defaultMessage:"Contact support"},pageAlreadyExists:{id:"issue.details.confluence-pages.product-requirements.page-already-exists",defaultMessage:"Product requirements page already exists"},pageAlreadyExistsDescription:{id:"issue.details.confluence-pages.product-requirements.page-already-exists-description",defaultMessage:"This epic has an existing product requirements page in Confluence. "},linkExistingPage:{id:"issue.details.confluence-pages.product-requirements.link-existing-page",defaultMessage:"Link existing page"},viewExistingPage:{id:"issue.details.confluence-pages.product-requirements.view-existing-page",defaultMessage:"View existing page"}})}}]);try{window.__jsEvalStop("async-product-requirements-touchpoint.js")}catch(e){}
//# sourceMappingURL=https://statlas.prod.atl-paas.net/jira-frontend-source-maps/assets/async-product-requirements-touchpoint.3b8ed6f3513461a743ff.8.js.map